# SIYI ZR10云台相机SDK协议提取

## 1. 协议格式说明

| 字段 | 索引 | 字节大小 | 内容说明 |
| --- | --- | --- | --- |
| STX | 0 | 2 | 0x6655 为起始标志 低字节在前 |
| CTRL | 2 | 1 | 0:need_ack 当前数据包是否需要ack 1:ack_pack 此包是否为ack 包 2-7:预留 |
| Data_len | 3 | 2 | 数据域字节长度 低字节在前 |
| SEQ | 5 | 2 | 帧的序列,范围(0~65535) 低字节在前 |
| CMD_ID | 7 | 1 | 命令ID |
| DATA | 8 | Data_len | 数据 |
| CRC16 | | 2 | 整个数据包的CRC16 校验 低字节在前 |

## 2. ZR10支持的通讯命令

### 2.1 请求云台相机固件版本号 (CMD_ID:0x01)

**发送数据格式**: 无数据

**ACK数据格式**:
- code_board_ver (uint32_t): 相机固件版本号
- gimbal_firmware_ver (uint32_t): 云台固件版本号
- zoom_firmware_ver (uint32_t): 变焦固件版本号

**注**: Eg:0x6E030203 对应版本号v3.2.3，第4字节(高字节)忽略

### 2.2 请求云台相机硬件ID (CMD_ID:0x02)

**发送数据格式**: 无数据

**ACK数据格式**:
- hardware_id (uint8_t[12]): 硬件ID字符串(10位数)

**注**: 硬件ID字符串前两位对应16进制产品ID，0x6B表示ZR10

### 2.3 请求云台相机当前工作模式 (CMD_ID:0x19)

**发送数据格式**: 无数据

**ACK数据格式**:
- gimbal_mode (uint8_t): 00:锁定模式 01:跟随模式 02:FPV模式

### 2.4 自动对焦 (CMD_ID:0x04)

**发送数据格式**:
- auto_focus (uint8_t): 1:启动一次自动对焦
- touch_x (uint16_t): x坐标,范围为视频流分辨率的宽大小
- touch_y (uint16_t): y坐标,范围为视频流分辨率的高大小

**ACK数据格式**:
- sta (uint8_t): 1:设置成功 0:设置出错

**注**: 在拼接画面下,X坐标取值为视频流分辨率的一半

### 2.5 手动变倍自动对焦 (CMD_ID:0x05)

**发送数据格式**:
- zoom (int8_t): 1:放大 0:停止缩放(松手后发送) -1:缩小

**ACK数据格式**:
- zoom_multiple (uint16_t): 当前(混合)变焦倍数 (zoom_multiple/10倍),精确到小数点后1位

### 2.6 绝对变倍自动对焦 (CMD_ID:0x0F)

**发送数据格式**:
- Absolute_movement_int (uint8_t): 指定倍数的整数部分(0x1~0x1E)
- Absolute_movement_float (uint8_t): 指定倍数的小数部分(0x0~0x9)

**ACK数据格式**:
- Absolute_movement_ask (uint8_t): 成功返回1

### 2.7 请求当前状态最大变倍值 (CMD_ID:0x16)

**发送数据格式**: 无数据

**ACK数据格式**:
- zoom_max_int (uint8_t): 最大变倍整数
- Zoom_max_float (uint8_t): 最大变倍小数

### 2.8 请求当前变倍值 (CMD_ID:0x18)

**发送数据格式**: 无数据

**ACK数据格式**:
- zoom_int (uint8_t): 当前变倍整数
- zoom_float (uint8_t): 当前变倍小数

### 2.9 手动对焦 (CMD_ID:0x06)

**发送数据格式**:
- focus (int8_t): 1:远景 0:停止对焦(松手后发送) -1:近景

**ACK数据格式**:
- sta (uint8_t): 1:设置成功 0:设置出错

### 2.10 云台转向 (CMD_ID:0x07)

**发送数据格式**:
- turn_yaw (int8_t): -100~0~100:正负代表两个方向,滑动越长,数值越大,转向速度越大,松手后发送0,停止转向。(向右滑动0~100,向左滑动0~(-100))
- turn_pitch (int8_t): -100~0~100:同上(向上滑动0~100,向下滑动0~(-100))

**ACK数据格式**:
- sta (uint8_t): 1:设置成功 0:设置出错

### 2.11 一键回中 (CMD_ID:0x08)

**发送数据格式**:
- center_pos (uint8_t): 1:触发回中

**ACK数据格式**:
- sta (uint8_t): 1:设置成功 0:设置出错

### 2.12 请求云台配置信息 (CMD_ID:0x0A)

**发送数据格式**: 无数据

**ACK数据格式**:
- reserved (uint8_t): 保留
- reserved (uint8_t): 保留
- record_sta (uint8_t): 0:未开启录像 1:已开启录像 2:未插入TF卡 3:(录像中)TF卡录制视频数据有丢失,请检查TF卡
- gimbal_motion_mode (uint8_t): 0:锁定模式 1:跟随模式 2:FPV模式
- gimbal_mounting_dir (uint8_t): 云台安装方向:0:reserved 1:正常 2:倒立

### 2.13 拍照、录像等 (CMD_ID:0x0C)

**发送数据格式**:
- func_type (uint8_t): 0:拍照 2:录像 3:运动模式:锁定模式 4:运动模式:跟随模式 5:运动模式:FPV模式

**ACK数据格式**: 无ack

### 2.14 发送控制角度到云台 (CMD_ID:0x0E)

**发送数据格式**:
- yaw (int16_t): 目标偏航角度
- pitch (int16_t): 目标俯仰角度

**ACK数据格式**:
- yaw (int16_t): 当前偏航角度
- pitch (int16_t): 当前俯仰角度
- roll (int16_t): 当前横滚角度

**注**:
1. 控制的角度精度为1位小数,eg:若要指定yaw为60.5度,则yaw字段需设置为605
2. 返回的当前实际角度除以10后为实际角度,精度为1位小数
3. 角度控制范围: Yaw: -135.0~135.0度, Pitch: -90.0~25.0度

### 2.15 请求云台发送数据流 (CMD_ID:0x25)

**发送数据格式**:
- data_type (uint8_t): 1:姿态数据
- data_freq (uint8_t): 输出频率: 0:关闭发送 1:2Hz 2:4Hz 3:5Hz 4:10Hz 5:20Hz 6:50Hz 7:100Hz

**ACK数据格式**:
- data_type (uint8_t): 1:姿态数据

## 3. 通讯接口

- TTL串口
  - 波特率:115200
  - 数据位:8位,停止位:1位,无校验
- UDP
  - IP:192.168.144.25
  - 端口号:37260
- TCP
  - IP:192.168.144.25
  - 端口号:37260

## 4. 通讯数据示例

- 请求云台相机当前工作模式：55 66 01 00 00 00 00 19 5D 57
- zoom 1：55 66 01 01 00 00 00 05 01 8d 64
- zoom -1：55 66 01 01 00 00 00 05 FF 5c 6a
- 绝对变倍(4.5倍)：55 66 01 02 00 10 00 0f 04 05 6b 15
- 请求变焦相机当前状态最大变倍值：55 66 01 00 00 00 00 16 B2 A6
- 请求变焦相机当前变倍值：55 66 01 00 00 00 00 18 7C 47