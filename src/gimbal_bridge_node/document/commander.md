<<<<<<< HEAD
# SIYI 思翼科技 www.sivi.biz

## 3.5 UART / UDP 控制(思翼云台SDK)
思翼光电吊舱(云台相机)面向用户开放所有功能控制协议,请基于下面的“思翼云台相机SDK 通讯协议”文件实现二次开发。

### 3.5.1 SDK 协议格式说明

| 字段 | 索引 | 字节大小 | 内容说明 |
| --- | --- | --- | --- |
| STX | 0 | 2 | 0x6655 为起始标志 低字节在前 |
| CTRL | 2 | 1 | 0:need_ack 当前数据包是否需要ack 1:ack_pack 此包是否为ack 包 2-7:预留 |
| Data_len | 3 | 2 | 数据域字节长度 低字节在前 |
| SEQ | 5 | 2 | 帧的序列,范围(0~65535) 低字节在前 |
| CMD_ID | 7 | 1 | 命令ID |
| DATA | 8 | Data_len | 数据 |
| CRC16 | | 2 | 整个数据包的CRC16 校验 低字节在前 |

### 3.5.2 SDK 通讯命令

#### TCP 心跳

| CMD_ID:0x00------TCP 心跳 |
| --- |
| send 数据格式 |

| 序号 | 数据类型 | 数据名 | 数据说明 |
| --- | --- | --- | --- |
| | | ACK 数据格式 | |
| | | | 无ack |

注:
1、心跳包:55 66 01 01 00 00 00 00 00 59 8B
2、仅使用TCP 协议连接时可用

#### 请求云台相机固件版本号

| CMD_ID:0x01------请求云台相机固件版本号 | | | |
| --- | --- | --- | --- |
| | | send 数据格式 | |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| ACK 数据格式 | | | |
| | uint32_t | code_board_ver | 相机固件版本号 |
| | uint32_t | gimbal_firmware_ver | 云台固件版本号 |
| | uint32_t | zoom_firmware_ver | 变焦固件版本号 |

Eg:0x6E030203 对应版本号v3.2.3

注:
1、第4 字节(高字节)忽略
2、变焦固件版本号命令目前仅ZT30、ZR30、ZR10 等支持光学变焦的型号可用

#### 请求云台相机硬件ID

| CMD_ID:0x02------ 请求云台相机硬件ID | | | |
| --- | --- | --- | --- |
| | | send 数据格式 | |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| ACK 数据格式 | | | |
| | Uint8_t | hardware_id[12] | 硬件ID 字符串(10 位数) |

注: 硬件ID 字符串前两位对应16 进制产品ID 0x6B: ZR10 0x73: A8 mini 0x75: A2 mini 0x78: ZR30 0x82: ZT6 0x7A: ZT30

#### 请求云台相机当前工作模式

| CMD_ID:0x19------请求云台相机当前工作模式 | | | |
| --- | --- | --- | --- |
| | | | send 数据格式 |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| | | | ACK 数据格式 |
| | uint8_t | | 00:锁定模式 |
| | gimbal_mode | 01:跟随模式 |
| | | 02:FPV 模式 |

#### 自动对焦
CMD_ID:0x04------自动对焦
注:
1、自动对焦命令目前仅ZT30、ZR30、ZR10 等支持光学变焦的型号可用
2、在拼接画面下,X 坐标取值为视频流分辨率的一半

| send 数据格式 | | | |
| --- | --- | --- | --- |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| | uint8_t | auto_focus | 1:启动一次自动对焦 |
| | uin16_t | touch_x | x 坐标,范围为视频流分辨率的宽大 小 |
| | uin16_t | touch_y | y 坐标,范围为视频流分辨率的高大 小 |
| ACK 数据格式 | | | |
| | uint8_t | sta | 1:设置成功 0:设置出错 |

#### 手动变倍自动对焦

| CMD_ID:0x05------手动变倍自动对焦 | | | |
| --- | --- | --- | --- |
| | | send 数据格式 | |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| 1 | int8_t | zoom | 1:放大 0:停止缩放(松手后发送) -1:缩小 |
| ACK 数据格式 | | | |
| | uint16_t | zoom_multiple | 当前(混合)变焦倍数 (zoom_multiple /10 倍),精确 到小数点后1 位 |

注:
1、手动变倍自动对焦命令目前仅ZT30、ZR30、ZR10 等支持光学变焦的型号可用
2、此命令下,ZT6、A8 mini 仅支持手动变倍,不支持自动对焦

#### 绝对变倍自动对焦

| CMD_ID:0x0F------绝对变倍自动对焦 send 数据格式 CMD ID:OxOF |
| --- |

| 序号 | 数据类型 | 数据名 | 数据说明 |
| --- | --- | --- | --- |
| 1 | uint8_t | Absolute_movement_int | 指定倍数的整数部分(0X1 ~ 0X1E) |
| 2 | uint8_t | Absolute_movement_float | 指定倍数的小数部分(0X0 ~ 0X9) |
| ACK 数据格式 | | | |
| | uint8_t | Absolute_movement_ask | 成功返回1 |

注:
1、绝对变倍自动对焦命令目前仅ZT30、ZR30、ZR10 等支持光学变焦的型号可用
2、此命令下,ZT6、A8 mini 仅支持绝对变倍,不支持自动对焦

#### 请求当前状态最大变倍值

| CMD_ID:0x16------获取当前状态最大变倍值 | | | |
| --- | --- | --- | --- |
| | | send 数据格式 | |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| ACK 数据格式 | | | |
| | uint8_t | zoom_max_int | 最大变倍整数 |
| | uint8_t | Zoom_max_float | 最大变倍小数 |

注:
获取当前状态最大变倍值命令仅支持有变倍功能的型号

#### 请求当前变倍值

| CMD_ID:0x18------请求当前变倍值 | | | |
| --- | --- | --- | --- |
| | | | send 数据格式 |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| | | | ACK 数据格式 |
| | uint8_t | zoom_int | 当前变倍整数 |
| | uint8_t | zoom_float | 当前变倍小数 |

注:
获取当前变倍值命令仅支持有变倍功能的型号

#### 手动对焦

| CMD_ID:0x06------手动对焦 | | | |
| --- | --- | --- | --- |
| | | send 数据格式 | |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| 1 | int8_t | focus | 1:远景 0:停止对焦(松手后发送) -1:近景 |
| ACK 数据格式 | | | |
| | uint8_t | sta | 1:设置成功 0:设置出错 |

注:
手动对焦命令目前仅ZT30、ZR30、ZR10 等支持光学变焦的型号可用

#### 云台转向

| CMD_ID:0x07------云台转向 | | | |
| --- | --- | --- | --- |
| | | send 数据格式 | |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| 1 | int8_t | turn_yaw | -100~0~100:正负代表两个方向, 滑动越长,数值越大,转向速度越 大,松手后发送0,停止转向。(向 右滑动0~100,向左滑动0~(-100)) |
| 2 | int8_t | turn_pitch | -100~0~100 :同上(向上滑动 0~100,向下滑动0~(-100)) |
| | | ACK 数据格式 | |
| | uint8_t | sta | 1:设置成功 0:设置出错 |

#### 一键回中

| CMD_ID:0x08------一键回中 | | | | |
| --- | --- | --- | --- | --- |
| | | | send 数据格式 | |
| 序号 | 数据类型 | 数据名 | | 数据说明 |
| 1 | uint8_t | center_pos | | 1:触发回中 |
| ACK 数据格式 | | | | |
| 1 | uint8_t | sta | | 1:设置成功 0:设置出错 |

#### 请求云台配置信息

| CMD_ID:0x0A------获取云台配置信息 | | | |
| --- | --- | --- | --- |
| | | send 数据格式 | |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| | | ACK 数据格式 | |
| 1 | uint8_t | reserved | |
| 3 | uint8_t | reserved | |
| 4 | uint8_t | record_sta | 0:未开启录像 1:已开启录像 2:未插入TF 卡 3:(录像中)TF 卡录制视频数据 有丢失,请检查TF 卡 |
| 5 | uint8_t | gimbal_motion_mode | 0:锁定模式 1:跟随模式 2:FPV 模式 |
| 6 | uint8_t | gimbal_mounting_dir | 云台安装方向:0:reserved 1:正常 2:倒立 |
| 7 | uint8_t | video_hdmi_or_cvbs | HDMI 和CVBS 视频输出状态 0: HDMI 视频输出打开 (仅ZT6、A8 mini 支持) CVBS 视频输出关闭 1: HDMI 视频输出关闭 CVBS 视频输出打开 |

#### 回传功能反馈信息
CMD_ID:0x0B------回传功能反馈信息
CMD ID:0x0B-

| send 数据格式 | | | |
| --- | --- | --- | --- |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| ACK 数据格式 | | | |
| 1 | uint8_t | info_type | 0:拍照成功 1:拍照失败,请检查是否插入TF 卡 2:HDR 模式开启 3:HDR 模式关闭 4:录像失败,请检查是否插入TF 卡 |

#### 拍照、录像等
CMD_ID:0x0C------拍照、录像等

| send 数据格式 | | | |
| --- | --- | --- | --- |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| | uint8_t | func_type | 0:拍照 1:HDR 切换(暂不支持) 2:录像 3:运动模式: 锁定模式 4:运动模式: 跟随模式 5:运动模式: FPV 模式 6:设置HDMI 视频输出(仅ZT6、A8 mini 支持,重启生效) 7:设置CVBS 视频输出(仅ZT6、A8 mini 支持,重启生效) 8:HDMI/CVBS 视频输出全部关闭 (仅ZT6、A8 mini 支持,重启生效) |
| ACK 数据格式 | | | |
| | | | 无ack |

| ACK 数据格式 | | |
| --- | --- | --- |
| int16_t | yaw | 转向角度 |
| int16_t | pitch | 俯仰角度 |
| int16_t | roll | 横滚角度 |
| int16_t | yaw_velocity | 转向角速度 |
| int16_t | pitch_velocity | 俯仰角速度 |
| int16_t | roll_velocity | 横滚角速度 |

注：
1、以上数据除以10 后为实际角度,精度为1 位小数
2、推荐使用0x25 命令设置姿态数据发送频率,即可按照指定频率主动持续发送

#### 发送控制角度到云台

| CMD ID:0x0E | | | |
| --- | --- | --- | --- |
| | | | send数据格式 |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| | int16_t | yaw | 目标偏航角度 |
| | int16_t | pitch | 目标俯仰角度 |
| | | | ACK数据格式 |
| | int16_t | yaw | 当前偏航角度 |
| | int16t | pitch | 当前俯仰角度 |
| | int16t | roll | 当前横滚角度 |

#### 单轴姿态控制(仅A8 mini 支持)

| | | |
| --- | --- | --- |
| uint8_t | single_control_flag | 需要控制的轴: 0:偏航 1:俯仰 |
| ACK 数据格式 | | |
| int16_t | yaw | 当前偏航角度 |
| int16_t | pitch | 当前俯仰角度 |
| int16_t | roll | 当前横滚角度 |

角度控制范围:
Yaw: -135.0 ~ 135.0 度
Pitch: -90.0 ~ 25.0 度

注:
1、控制的角度精度为1 位小数,eg:若要指定yaw 为60.5 度,则yaw 字段需设置为605
2、返回的当前实际角度除以10 后为实际角度,精度为1 位小数

#### 请求云台相机编码参数

| | | | |
| --- | --- | --- | --- |
| uint16_t | Resolution_L | 分辨率宽 | |
| uint16_t | VideoBitrate | 视频码率单位Kbps | |
| uint8_t | VideoFrameRate | 帧率 | |

#### CMD_ID:0x21------发送编码参数到云台相机

| 编码格式 | | | |
| --- | --- | --- | --- |
| uint8_t | VideoEncType | 1:H264 2:H265 | |
| uint16_t | Resolution_L | 分辨率宽:1920,1280 | |
| uint16_t | Resolution_H | 分辨率高:1080,720 | |
| uint16_t | VideoBitrate | 视频码率单位Kbps | |
| uint8_t | reserve | 保留 | |
| ACK 数据格式 | | | |
| uint8_t | stream_type | 0:录像流 1:主码流 2:副码流( 仅ZT30、ZT6 支持 ) | |
| uint8_t | sta | 1:设置成功 0:设置出错 | |

#### CMD_ID:0x10------请求云台相机视频拼接模式

| 数据类型 | 数据名 | send 数据格式 数据说明 | |
| --- | --- | --- | --- |
| | | ACK 数据格式 | |
| uint8_t | vdisp_mode | 画面拼接模式: 0:拼接模式(主码流:变焦&热成像副码流: 广角) 1:拼接模式(主码流:广角&热成像副码流: 变焦) 2:拼接模式(主码流:变焦&广角副码流:热 成像) 3:非拼接模式(主码流:变焦副码流:热成像) | |

| CMD ID:0x10 请求云台相机视频拼接模式 send数据格式 | | | |
| --- | --- | --- | --- |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| 1 | uint8t | vdisp_mode | 画面拼接模式: 0:拼接模式(主码流:变焦&热成像副码流: 广角) 1:拼接模式(主码流:广角&热成像副码流: 变焦) 2:拼接模式(主码流:变焦&广角副码流:热 成像) 3:非拼接模式(主码流:变焦副码流:热成像) 4:非拼接模式(主码流:变焦副码流:广角) 5:非拼接模式(主码流:广角副码流:热成像) |

注:
获取视频拼接模式命令目前仅ZT30、ZT6 可用

#### 发送视频拼接模式到云台相机
CMD_ID:0x11------发送视频拼接模式到云台相机

| send 数据格式 | | | |
| --- | --- | --- | --- |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| | | | ACK 数据格式 |
| 1 | uint8_t | vdisp_mode | 画面拼接模式: 0:拼接模式(主码流:变焦&热成像副码 流:广角) 1:拼接模式(主码流:广角&热成像副码 流:变焦) 2:拼接模式(主码流:变焦&广角副码流: 热成像) 3:非拼接模式(主码流:变焦副码流:热 成像) 4:非拼接模式(主码流:变焦副码流:广 角) 5:非拼接模式(主码流:广角副码流:热 成像) 6:非拼接模式(主码流:广角副码流:变 焦) 7:非拼接模式(主码流:热成像副码流: 变焦) 8:非拼接模式(主码流:热成像副码流: 广角) |

注:
设置视频拼接模式命令目前仅ZT30、ZT6 可用

#### 请求选定点的温度

| | | | send 数据格式 |
| --- | --- | --- | --- |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| 1 | uint16_t | x | 选定点的x 坐标 |
| 2 | uint16_t | y | 选定点的y 坐标 |
| 3 | uint8_t | get_temp_flag | 0:关闭测量 1:测量一次 2:持续测量(5 Hz) |
| | | | ACK 数据格式 |
| 1 | uint16_t | temp | 选定点的温度,除以100 保留两位小数 |
| 1 | uint16_t | x | 选定点的x 坐标 |
| 2 | uint16_t | y | 选定点的y 坐标 |

注:
读取选定点的温度命令目前仅ZT30、ZT6 可用

#### 区域测温(选定区域的最大、最小值)
CMD_ID:0x13------区域测温(选定区域的最大最小值)

| send 数据格式 | | | |
| --- | --- | --- | --- |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| 1 | uint16_t | startx | 方框起点的x 坐标 |
| 2 | uint16_t | starty | 方框起点的y 坐标 |
| 3 | uint16_t | endx | 方框终点的x 坐标 |
| 4 | uint16_t | endy | 方框终点的y 坐标 |
| 5 | uint8_t | get_temp_flag | 0:关闭测量 1:测量一次 2:持续测量(5 Hz) |
| ACK 数据格式 | | | |
| 1 | uint16_t | startx | 方框起点的x 坐标 |
| 2 | uint16_t | starty | 方框起点的y 坐标 |
| 3 | uint16_t | endx | 方框终点的x 坐标 |
| 4 | uint16_t | endy | 方框终点的y 坐标 |
| 5 | uint16_t | temp_max | 方框内的最大温度,除以100 保留两位小数 |
| 6 | uint16_t | temp_min | 方框内的最小温度,除以100 保留两位小数 |
| 7 | uint16_t | temp_max_x | 方框内的最大温度的x 坐标 |
| 8 | uint16_t | temp_max_y | 方框内的最大温度的y 坐标 |
| 9 | uint16_t | temp_min_x | 方框内的最小温度的x 坐标 |
| 10 | uint16_t | temp_min_y | 方框内的最小温度的y 坐标 |

| ACK 数据格式 | | |
| --- | --- | --- |
| uint16_t | temp_min | 整帧画面内的最小温度,除以100 保留两位 小数 |
| uint16_t | temp_max_x | 整帧画面内的最大温度的x 坐标 |
| uint16_t | temp_max_y | 整帧画面内的最大温度的y 坐标 |
| uint16_t | temp_min_x | 整帧画面内的最小温度的x 坐标 |
| uint16_t | temp_min_y | 整帧画面内的最小温度的y 坐标 |

注:全局测温命令目前仅ZT30、ZT6 可用

#### CMD_ID:0x1A------请求热成像调色盘

| 数据类型 | 数据名 | send 数据格式 数据说明 |
| --- | --- | --- |
| | | ACK 数据格式 |
| | | 共11 种色板: 0:白热White_Hot 1:保留 2:辉金Sepia 3:铁红Ironbow 4:彩虹Rainbow 5:微光Night 6:极光Aurora 7:红热Red_Hot 8:丛林Jungle 9:医疗Medical 10:黑热Black_Hot 11:金红Glory_Hot |

注:获取热成像调色盘命令目前仅ZT30、ZT6 可用

#### 发送热成像调色盘命令到云台相机

| CMD_ID:0x1B------发送热成像伪彩色到云台相机 | | | | |
| --- | --- | --- | --- | --- |
| | | | send 数据格式 | |
| 序号 | 数据类型 | 数据名 | pseudo color ACK 数据格式 | 数据说明 |
| | uint8_t | | 共11 种色板: 0:白热White_Hot 1:保留 2:辉金Sepia 3:铁红Ironbow 4:彩虹Rainbow 5:微光Night 6:极光Aurora 7:红热Red_Hot 8:丛林Jungle 9:医疗Medical 10:黑热Black_Hot 11:金红Glory_Hot |
| | uint8_t | pseudo color | 共11 种色板: 0:白热White_Hot 1:保留 2:辉金Sepia 3:铁红Ironbow 4:彩虹Rainbow 5:微光Night 6:极光Aurora 7:红热Red_Hot 8:丛林Jungle 9:医疗Medical 10:黑热Black_Hot 11:金红Glory_Hot | |

注:设置热成像调色板命令目前仅ZT30、ZT6 可用

#### 请求热成像相机原始数据

| CMD_ID:0x33------请求热成像相机原始数据 | | | |
| --- | --- | --- | --- |
| | | send 数据格式 | |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| | ACK 数据格式 | | |
| | uint8_t | mode | 0: 30 fps 1: 25 fps 并输出温度帧 |

#### CMD_ID:0x35------请求一次热成像相机温度帧 send 数据格式

#### CMD_ID:0x37------请求热成像增益模式

| | | |
| --- | --- | --- |
| 数据类型 | 数据名 | 数据说明 |
| | | ACK 数据格式 |
| uint8_t | Ir_gain | 0: 低增益 1: 高增益 |

| CMD_ID:0x37 | 请求热成像增益模式 | | |
| --- | --- | --- | --- |
| send数据格式 | | | |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| | ACK数据格式 | | |
| 1 | uint8_t | Ir_gain | 0:低增益 1:高增益 |

| send 数据格式 | | |
| --- | --- | --- |
| | | ACK 数据格式 |
| uint8_t | Ir_gain | 0: 低增益 1: 高增益 |

注:发送热成像增益模式到云台命令目前仅ZT30、ZT6 可用

#### 请求热成像环境校准开关

| 发送热成像环境校准命令到云台 | | |
| --- | --- | --- |
| CMD_ID:0x3A------发送热成像环境校准命令到云台 | | |
| 数据类型 | 数据名 | send 数据格式 数据说明 0: 关闭 |

注:此命令目前仅ZT30、ZT6 可用

#### 发送热成像环境校准命令到云台

| CMD_ID:0x3B------请求热成像环境校准参数 | | |
| --- | --- | --- |
| | | send 数据格式 |
| 数据类型 | 数据名 | 数据说明 |
| uint16_t | Dist | ACK 数据格式 距离(单位m) |
| uint16_t | Ems | 目标发射率(%) |
| uint16_t | Hum | 环境湿度(%) |
| uint16_t | Ta | 大气温度(单位°C) |

注:此命令目前仅ZT30、ZT6 可用

#### 请求热成像环境校准参数

| 请求热成像环境校准参数 CMD ID:0x3B | | | |
| --- | --- | --- | --- |
| | | | send数据格式 |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| ACK数据格式 | | | |
| 1 | uint16_t | Dist | 距离(单位m) |
| 2 | uint16_t | Ems | 目标发射率(%) |
| 3 | uint16_t | Hum | 环境湿度(%) |
| 4 | uint16_t | Ta | 大气温度(单位°C) |
| 5 | uint16_t | Tu | 反射温度(单位°C) |

注:
1、此协议的参数均除以100 保留两位小数
2、此命令目前仅ZT30、ZT6 可用

#### 发送热成像环境校准参数到云台

| send 数据格式 | | | |
| --- | --- | --- | --- |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| 1 | uint16_t | Dist | 距离(单位m) |
| 2 | uint16_t | Ems | 目标发射率(%) |
| 3 | uint16_t | Hum | 环境湿度(%) |
| 4 | uint16_t | Ta | 大气温度(单位°C) |
| 5 | uint16_t | Tu | 反射温度(单位°C) |
| | | | ACK 数据格式 |
| 1 | uint8_t | ack | 1:设置成功 |

注:
1、此协议的参数均除以100 保留两位小数
2、此命令目前仅ZT30、ZT6 可用

#### 读取激光测距信息

| CMD_ID:0x15------读取激光测距信息 | | | |
| --- | --- | --- | --- |
| | | | send 数据格式 |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| | ACK 数据格式 | | |
| 1 | uint16_t | info_type | 激光测距距离数值,低位在前,高位在后, 最小值50,数据单位dm |

注:读取激光测距信息命令目前仅ZT30 可用

#### 请求激光测距目标的经纬度信息

| CMD_ID:0x17------请求激光测距目标的经纬度信息 | | | |
| --- | --- | --- | --- |
| | | send 数据格式 | |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| ACK 数据格式 | | | |
| 1 | int32_t | lon_degE7 | 经度[degE7] Longitude (WGS84, EGM96 椭 球体) |
| 2 | int32_t | lat_degE7 | 纬度[degE7] Latitude (WGS84, EGM96 椭 球体) |

注:请求激光测距目标的经纬度信息命令目前仅ZT30 可用

#### 请求激光测距状态信息

| CMD_ID:0x31------请求激光状态信息 | | | | |
| --- | --- | --- | --- | --- |
| | | | | send 数据格式 |
| 序号 | 数据类型 | 数据名 | | 数据说明 |
| ACK 数据格式 | | | | |
| 1 | uint8_t | laser_state | | 1:激光测距打开 0:激光测距关闭 |

注:读取激光测距信息命令目前仅ZT30 可用

#### 发送激光测距状态到云台

| CMD_ID:0x32------发送激光测距状态到云台 | | | |
| --- | --- | --- | --- |
| | | send 数据格式 | |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| 1 | uint8_t | laser_state | 1:激光测距打开 0:激光测距关闭 |
| ACK 数据格式 | | | |
| 1 | uint8_t | sta | 1:设置成功 0:设置失败 |

注:发送激光测距状态到云台命令目前仅ZT30 可用

#### 将飞控姿态数据发送至云台UART 串口

| | | | send 数据格式 |
| --- | --- | --- | --- |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| 1 | float | roll | [rad] Roll angle (-pi..+pi) |
| 2 | float | pitch | [rad] Pitch angle (-pi/2..+pi/2) |
| 3 | float | yaw | [rad] Yaw angle (-pi..+pi) |
| 4 | float | rollspeed | [rad/s] Roll angular speed |
| 5 | float | pitchspeed | [rad/s] Pitch angular speed |
| 6 | float | yawspeed | [rad/s] Yaw angular speed |
| | ACK 数据格式 | | |

#### 请求飞控发送数据流至云台
CMD_ID:0x24------请求飞控发送数据流至云台 CMD ID:0x24

| send 数据格式 | | | |
| --- | --- | --- | --- |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| 1 | uint8_t | data_type | 1:姿态数据 2:RC 通道数据( 暂未使用) |
| 2 | uint8_t | data_freq | 输出频率: 0:关闭发送 1:2 Hz 2:4 Hz 3:5 Hz 4:10 Hz 5:20 Hz 6:50 Hz 7:100 Hz |
| ACK 数据格式 | | | |
| 1 | uint8_t | data_type | 1:姿态数据 2:RC 通道数据 |

#### 请求云台发送数据流

| CMD_ID:0x25------请求云台发送数据流 | | | |
| --- | --- | --- | --- |
| | | | send 数据格式 |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| 1 | uint8_t | data_type | 1:姿态数据 2:激光测距数据 |
| 2 | uint8_t | data_freq | 输出频率: 0:关闭发送 1:2 Hz 2:4 Hz 3:5 Hz 4:10 Hz 5:20 Hz 6:50 Hz 7:100 Hz |
| ACK 数据格式 | | | |
| | uint8_t | data_type | 1:姿态数据 2:激光测距数据 |

注：
1、请求激光测距数据命令目前仅ZT30 可用

#### CMD_ID:0x48------格式化SDK

| | | |
| --- | --- | --- |
| | | send 数据格式 |
| 数据类型 | 数据名 | 数据说明 |
| | | ACK 数据格式 |
| uint8_t | format_sta | 0:格式化失败 1:格式化成功 |

| | | | |
| --- | --- | --- | --- |
| | uint8_t | Camera_reboot | 1:相机重启 | |
| | uint8_t | Gimbal_reset | 0:无动作 1:云台重启 | |
| | ACK 数据格式 | | | |
| | uint8_t | Camera_reboot_sta | 0:无动作 1:相机重启 | |
| | uint8_t | Gimbal_reset_st | 0:无动作 1:云台重启 | |

#### 云台相机软重启 CMD ID:0x80

| | | send数据格式 | | |
| --- | --- | --- | --- | --- |
| 序号 | 数据类型 | 数据名 | | 数据说明 |
| 1 | uint8_t | Camera_reboot | | 0:无动作 1:相机重启 |
| 2 | uint8_t | Gimbal_reset | | 0:无动作 1:云台重启 |
| ACK数据格式 | | | | |
| 1 | uint8_t | Camera_reboot_sta | | 0:无动作 1:相机重启 |
| 2 | uint8_t | Gimbal reset_st | | 0:无动作 1:云台重启 |

### 3.5.3 SDK 通讯接口
- TTL 串口
  - 波特率:115200
  - 数据位:8 位,停止位:1 位,无校验
- UDP
  - IP:192.168.144.25
  - 端口号:37260
- TCP
  - IP:192.168.144.25
  - 端口号:37260

心跳包数据:55 66 01 01 00 00 00 00 00 59 8B

### 3.5.4 SDK 通讯数据示例
- 请求云台相机当前工作模式：55 66 01 00 00 00 00 19 5D 57
- zoom 1：55 66 01 01 00 00 00 05 01 8d 64
- zoom -1：55 66 01 01 00 00 00 05 FF 5c 6a
- 绝对变倍(4.5 倍)：55 66 01 02 00 10 00 0f 04 05 6b 15
- 请求变焦相机当前状态最大变倍值：55 66 01 00 00 00 00 16 B2 A6
- 请求变焦相机当前变倍值：55 66 01 00 00 00 00 18 7C 47

=======
# SIYI 思翼科技 www.sivi.biz

## 3.5 UART / UDP 控制(思翼云台SDK)
思翼光电吊舱(云台相机)面向用户开放所有功能控制协议,请基于下面的“思翼云台相机SDK 通讯协议”文件实现二次开发。

### 3.5.1 SDK 协议格式说明

| 字段 | 索引 | 字节大小 | 内容说明 |
| --- | --- | --- | --- |
| STX | 0 | 2 | 0x6655 为起始标志 低字节在前 |
| CTRL | 2 | 1 | 0:need_ack 当前数据包是否需要ack 1:ack_pack 此包是否为ack 包 2-7:预留 |
| Data_len | 3 | 2 | 数据域字节长度 低字节在前 |
| SEQ | 5 | 2 | 帧的序列,范围(0~65535) 低字节在前 |
| CMD_ID | 7 | 1 | 命令ID |
| DATA | 8 | Data_len | 数据 |
| CRC16 | | 2 | 整个数据包的CRC16 校验 低字节在前 |

### 3.5.2 SDK 通讯命令

#### TCP 心跳

| CMD_ID:0x00------TCP 心跳 |
| --- |
| send 数据格式 |

| 序号 | 数据类型 | 数据名 | 数据说明 |
| --- | --- | --- | --- |
| | | ACK 数据格式 | |
| | | | 无ack |

注:
1、心跳包:55 66 01 01 00 00 00 00 00 59 8B
2、仅使用TCP 协议连接时可用

#### 请求云台相机固件版本号

| CMD_ID:0x01------请求云台相机固件版本号 | | | |
| --- | --- | --- | --- |
| | | send 数据格式 | |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| ACK 数据格式 | | | |
| | uint32_t | code_board_ver | 相机固件版本号 |
| | uint32_t | gimbal_firmware_ver | 云台固件版本号 |
| | uint32_t | zoom_firmware_ver | 变焦固件版本号 |

Eg:0x6E030203 对应版本号v3.2.3

注:
1、第4 字节(高字节)忽略
2、变焦固件版本号命令目前仅ZT30、ZR30、ZR10 等支持光学变焦的型号可用

#### 请求云台相机硬件ID

| CMD_ID:0x02------ 请求云台相机硬件ID | | | |
| --- | --- | --- | --- |
| | | send 数据格式 | |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| ACK 数据格式 | | | |
| | Uint8_t | hardware_id[12] | 硬件ID 字符串(10 位数) |

注: 硬件ID 字符串前两位对应16 进制产品ID 0x6B: ZR10 0x73: A8 mini 0x75: A2 mini 0x78: ZR30 0x82: ZT6 0x7A: ZT30

#### 请求云台相机当前工作模式

| CMD_ID:0x19------请求云台相机当前工作模式 | | | |
| --- | --- | --- | --- |
| | | | send 数据格式 |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| | | | ACK 数据格式 |
| | uint8_t | | 00:锁定模式 |
| | gimbal_mode | 01:跟随模式 |
| | | 02:FPV 模式 |

#### 自动对焦
CMD_ID:0x04------自动对焦
注:
1、自动对焦命令目前仅ZT30、ZR30、ZR10 等支持光学变焦的型号可用
2、在拼接画面下,X 坐标取值为视频流分辨率的一半

| send 数据格式 | | | |
| --- | --- | --- | --- |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| | uint8_t | auto_focus | 1:启动一次自动对焦 |
| | uin16_t | touch_x | x 坐标,范围为视频流分辨率的宽大 小 |
| | uin16_t | touch_y | y 坐标,范围为视频流分辨率的高大 小 |
| ACK 数据格式 | | | |
| | uint8_t | sta | 1:设置成功 0:设置出错 |

#### 手动变倍自动对焦

| CMD_ID:0x05------手动变倍自动对焦 | | | |
| --- | --- | --- | --- |
| | | send 数据格式 | |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| 1 | int8_t | zoom | 1:放大 0:停止缩放(松手后发送) -1:缩小 |
| ACK 数据格式 | | | |
| | uint16_t | zoom_multiple | 当前(混合)变焦倍数 (zoom_multiple /10 倍),精确 到小数点后1 位 |

注:
1、手动变倍自动对焦命令目前仅ZT30、ZR30、ZR10 等支持光学变焦的型号可用
2、此命令下,ZT6、A8 mini 仅支持手动变倍,不支持自动对焦

#### 绝对变倍自动对焦

| CMD_ID:0x0F------绝对变倍自动对焦 send 数据格式 CMD ID:OxOF |
| --- |

| 序号 | 数据类型 | 数据名 | 数据说明 |
| --- | --- | --- | --- |
| 1 | uint8_t | Absolute_movement_int | 指定倍数的整数部分(0X1 ~ 0X1E) |
| 2 | uint8_t | Absolute_movement_float | 指定倍数的小数部分(0X0 ~ 0X9) |
| ACK 数据格式 | | | |
| | uint8_t | Absolute_movement_ask | 成功返回1 |

注:
1、绝对变倍自动对焦命令目前仅ZT30、ZR30、ZR10 等支持光学变焦的型号可用
2、此命令下,ZT6、A8 mini 仅支持绝对变倍,不支持自动对焦

#### 请求当前状态最大变倍值

| CMD_ID:0x16------获取当前状态最大变倍值 | | | |
| --- | --- | --- | --- |
| | | send 数据格式 | |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| ACK 数据格式 | | | |
| | uint8_t | zoom_max_int | 最大变倍整数 |
| | uint8_t | Zoom_max_float | 最大变倍小数 |

注:
获取当前状态最大变倍值命令仅支持有变倍功能的型号

#### 请求当前变倍值

| CMD_ID:0x18------请求当前变倍值 | | | |
| --- | --- | --- | --- |
| | | | send 数据格式 |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| | | | ACK 数据格式 |
| | uint8_t | zoom_int | 当前变倍整数 |
| | uint8_t | zoom_float | 当前变倍小数 |

注:
获取当前变倍值命令仅支持有变倍功能的型号

#### 手动对焦

| CMD_ID:0x06------手动对焦 | | | |
| --- | --- | --- | --- |
| | | send 数据格式 | |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| 1 | int8_t | focus | 1:远景 0:停止对焦(松手后发送) -1:近景 |
| ACK 数据格式 | | | |
| | uint8_t | sta | 1:设置成功 0:设置出错 |

注:
手动对焦命令目前仅ZT30、ZR30、ZR10 等支持光学变焦的型号可用

#### 云台转向

| CMD_ID:0x07------云台转向 | | | |
| --- | --- | --- | --- |
| | | send 数据格式 | |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| 1 | int8_t | turn_yaw | -100~0~100:正负代表两个方向, 滑动越长,数值越大,转向速度越 大,松手后发送0,停止转向。(向 右滑动0~100,向左滑动0~(-100)) |
| 2 | int8_t | turn_pitch | -100~0~100 :同上(向上滑动 0~100,向下滑动0~(-100)) |
| | | ACK 数据格式 | |
| | uint8_t | sta | 1:设置成功 0:设置出错 |

#### 一键回中

| CMD_ID:0x08------一键回中 | | | | |
| --- | --- | --- | --- | --- |
| | | | send 数据格式 | |
| 序号 | 数据类型 | 数据名 | | 数据说明 |
| 1 | uint8_t | center_pos | | 1:触发回中 |
| ACK 数据格式 | | | | |
| 1 | uint8_t | sta | | 1:设置成功 0:设置出错 |

#### 请求云台配置信息

| CMD_ID:0x0A------获取云台配置信息 | | | |
| --- | --- | --- | --- |
| | | send 数据格式 | |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| | | ACK 数据格式 | |
| 1 | uint8_t | reserved | |
| 3 | uint8_t | reserved | |
| 4 | uint8_t | record_sta | 0:未开启录像 1:已开启录像 2:未插入TF 卡 3:(录像中)TF 卡录制视频数据 有丢失,请检查TF 卡 |
| 5 | uint8_t | gimbal_motion_mode | 0:锁定模式 1:跟随模式 2:FPV 模式 |
| 6 | uint8_t | gimbal_mounting_dir | 云台安装方向:0:reserved 1:正常 2:倒立 |
| 7 | uint8_t | video_hdmi_or_cvbs | HDMI 和CVBS 视频输出状态 0: HDMI 视频输出打开 (仅ZT6、A8 mini 支持) CVBS 视频输出关闭 1: HDMI 视频输出关闭 CVBS 视频输出打开 |

#### 回传功能反馈信息
CMD_ID:0x0B------回传功能反馈信息
CMD ID:0x0B-

| send 数据格式 | | | |
| --- | --- | --- | --- |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| ACK 数据格式 | | | |
| 1 | uint8_t | info_type | 0:拍照成功 1:拍照失败,请检查是否插入TF 卡 2:HDR 模式开启 3:HDR 模式关闭 4:录像失败,请检查是否插入TF 卡 |

#### 拍照、录像等
CMD_ID:0x0C------拍照、录像等

| send 数据格式 | | | |
| --- | --- | --- | --- |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| | uint8_t | func_type | 0:拍照 1:HDR 切换(暂不支持) 2:录像 3:运动模式: 锁定模式 4:运动模式: 跟随模式 5:运动模式: FPV 模式 6:设置HDMI 视频输出(仅ZT6、A8 mini 支持,重启生效) 7:设置CVBS 视频输出(仅ZT6、A8 mini 支持,重启生效) 8:HDMI/CVBS 视频输出全部关闭 (仅ZT6、A8 mini 支持,重启生效) |
| ACK 数据格式 | | | |
| | | | 无ack |

| ACK 数据格式 | | |
| --- | --- | --- |
| int16_t | yaw | 转向角度 |
| int16_t | pitch | 俯仰角度 |
| int16_t | roll | 横滚角度 |
| int16_t | yaw_velocity | 转向角速度 |
| int16_t | pitch_velocity | 俯仰角速度 |
| int16_t | roll_velocity | 横滚角速度 |

注：
1、以上数据除以10 后为实际角度,精度为1 位小数
2、推荐使用0x25 命令设置姿态数据发送频率,即可按照指定频率主动持续发送

#### 发送控制角度到云台

| CMD ID:0x0E | | | |
| --- | --- | --- | --- |
| | | | send数据格式 |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| | int16_t | yaw | 目标偏航角度 |
| | int16_t | pitch | 目标俯仰角度 |
| | | | ACK数据格式 |
| | int16_t | yaw | 当前偏航角度 |
| | int16t | pitch | 当前俯仰角度 |
| | int16t | roll | 当前横滚角度 |

#### 单轴姿态控制(仅A8 mini 支持)

| | | |
| --- | --- | --- |
| uint8_t | single_control_flag | 需要控制的轴: 0:偏航 1:俯仰 |
| ACK 数据格式 | | |
| int16_t | yaw | 当前偏航角度 |
| int16_t | pitch | 当前俯仰角度 |
| int16_t | roll | 当前横滚角度 |

角度控制范围:
Yaw: -135.0 ~ 135.0 度
Pitch: -90.0 ~ 25.0 度

注:
1、控制的角度精度为1 位小数,eg:若要指定yaw 为60.5 度,则yaw 字段需设置为605
2、返回的当前实际角度除以10 后为实际角度,精度为1 位小数

#### 请求云台相机编码参数

| | | | |
| --- | --- | --- | --- |
| uint16_t | Resolution_L | 分辨率宽 | |
| uint16_t | VideoBitrate | 视频码率单位Kbps | |
| uint8_t | VideoFrameRate | 帧率 | |

#### CMD_ID:0x21------发送编码参数到云台相机

| 编码格式 | | | |
| --- | --- | --- | --- |
| uint8_t | VideoEncType | 1:H264 2:H265 | |
| uint16_t | Resolution_L | 分辨率宽:1920,1280 | |
| uint16_t | Resolution_H | 分辨率高:1080,720 | |
| uint16_t | VideoBitrate | 视频码率单位Kbps | |
| uint8_t | reserve | 保留 | |
| ACK 数据格式 | | | |
| uint8_t | stream_type | 0:录像流 1:主码流 2:副码流( 仅ZT30、ZT6 支持 ) | |
| uint8_t | sta | 1:设置成功 0:设置出错 | |

#### CMD_ID:0x10------请求云台相机视频拼接模式

| 数据类型 | 数据名 | send 数据格式 数据说明 | |
| --- | --- | --- | --- |
| | | ACK 数据格式 | |
| uint8_t | vdisp_mode | 画面拼接模式: 0:拼接模式(主码流:变焦&热成像副码流: 广角) 1:拼接模式(主码流:广角&热成像副码流: 变焦) 2:拼接模式(主码流:变焦&广角副码流:热 成像) 3:非拼接模式(主码流:变焦副码流:热成像) | |

| CMD ID:0x10 请求云台相机视频拼接模式 send数据格式 | | | |
| --- | --- | --- | --- |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| 1 | uint8t | vdisp_mode | 画面拼接模式: 0:拼接模式(主码流:变焦&热成像副码流: 广角) 1:拼接模式(主码流:广角&热成像副码流: 变焦) 2:拼接模式(主码流:变焦&广角副码流:热 成像) 3:非拼接模式(主码流:变焦副码流:热成像) 4:非拼接模式(主码流:变焦副码流:广角) 5:非拼接模式(主码流:广角副码流:热成像) |

注:
获取视频拼接模式命令目前仅ZT30、ZT6 可用

#### 发送视频拼接模式到云台相机
CMD_ID:0x11------发送视频拼接模式到云台相机

| send 数据格式 | | | |
| --- | --- | --- | --- |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| | | | ACK 数据格式 |
| 1 | uint8_t | vdisp_mode | 画面拼接模式: 0:拼接模式(主码流:变焦&热成像副码 流:广角) 1:拼接模式(主码流:广角&热成像副码 流:变焦) 2:拼接模式(主码流:变焦&广角副码流: 热成像) 3:非拼接模式(主码流:变焦副码流:热 成像) 4:非拼接模式(主码流:变焦副码流:广 角) 5:非拼接模式(主码流:广角副码流:热 成像) 6:非拼接模式(主码流:广角副码流:变 焦) 7:非拼接模式(主码流:热成像副码流: 变焦) 8:非拼接模式(主码流:热成像副码流: 广角) |

注:
设置视频拼接模式命令目前仅ZT30、ZT6 可用

#### 请求选定点的温度

| | | | send 数据格式 |
| --- | --- | --- | --- |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| 1 | uint16_t | x | 选定点的x 坐标 |
| 2 | uint16_t | y | 选定点的y 坐标 |
| 3 | uint8_t | get_temp_flag | 0:关闭测量 1:测量一次 2:持续测量(5 Hz) |
| | | | ACK 数据格式 |
| 1 | uint16_t | temp | 选定点的温度,除以100 保留两位小数 |
| 1 | uint16_t | x | 选定点的x 坐标 |
| 2 | uint16_t | y | 选定点的y 坐标 |

注:
读取选定点的温度命令目前仅ZT30、ZT6 可用

#### 区域测温(选定区域的最大、最小值)
CMD_ID:0x13------区域测温(选定区域的最大最小值)

| send 数据格式 | | | |
| --- | --- | --- | --- |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| 1 | uint16_t | startx | 方框起点的x 坐标 |
| 2 | uint16_t | starty | 方框起点的y 坐标 |
| 3 | uint16_t | endx | 方框终点的x 坐标 |
| 4 | uint16_t | endy | 方框终点的y 坐标 |
| 5 | uint8_t | get_temp_flag | 0:关闭测量 1:测量一次 2:持续测量(5 Hz) |
| ACK 数据格式 | | | |
| 1 | uint16_t | startx | 方框起点的x 坐标 |
| 2 | uint16_t | starty | 方框起点的y 坐标 |
| 3 | uint16_t | endx | 方框终点的x 坐标 |
| 4 | uint16_t | endy | 方框终点的y 坐标 |
| 5 | uint16_t | temp_max | 方框内的最大温度,除以100 保留两位小数 |
| 6 | uint16_t | temp_min | 方框内的最小温度,除以100 保留两位小数 |
| 7 | uint16_t | temp_max_x | 方框内的最大温度的x 坐标 |
| 8 | uint16_t | temp_max_y | 方框内的最大温度的y 坐标 |
| 9 | uint16_t | temp_min_x | 方框内的最小温度的x 坐标 |
| 10 | uint16_t | temp_min_y | 方框内的最小温度的y 坐标 |

| ACK 数据格式 | | |
| --- | --- | --- |
| uint16_t | temp_min | 整帧画面内的最小温度,除以100 保留两位 小数 |
| uint16_t | temp_max_x | 整帧画面内的最大温度的x 坐标 |
| uint16_t | temp_max_y | 整帧画面内的最大温度的y 坐标 |
| uint16_t | temp_min_x | 整帧画面内的最小温度的x 坐标 |
| uint16_t | temp_min_y | 整帧画面内的最小温度的y 坐标 |

注:全局测温命令目前仅ZT30、ZT6 可用

#### CMD_ID:0x1A------请求热成像调色盘

| 数据类型 | 数据名 | send 数据格式 数据说明 |
| --- | --- | --- |
| | | ACK 数据格式 |
| | | 共11 种色板: 0:白热White_Hot 1:保留 2:辉金Sepia 3:铁红Ironbow 4:彩虹Rainbow 5:微光Night 6:极光Aurora 7:红热Red_Hot 8:丛林Jungle 9:医疗Medical 10:黑热Black_Hot 11:金红Glory_Hot |

注:获取热成像调色盘命令目前仅ZT30、ZT6 可用

#### 发送热成像调色盘命令到云台相机

| CMD_ID:0x1B------发送热成像伪彩色到云台相机 | | | | |
| --- | --- | --- | --- | --- |
| | | | send 数据格式 | |
| 序号 | 数据类型 | 数据名 | pseudo color ACK 数据格式 | 数据说明 |
| | uint8_t | | 共11 种色板: 0:白热White_Hot 1:保留 2:辉金Sepia 3:铁红Ironbow 4:彩虹Rainbow 5:微光Night 6:极光Aurora 7:红热Red_Hot 8:丛林Jungle 9:医疗Medical 10:黑热Black_Hot 11:金红Glory_Hot |
| | uint8_t | pseudo color | 共11 种色板: 0:白热White_Hot 1:保留 2:辉金Sepia 3:铁红Ironbow 4:彩虹Rainbow 5:微光Night 6:极光Aurora 7:红热Red_Hot 8:丛林Jungle 9:医疗Medical 10:黑热Black_Hot 11:金红Glory_Hot | |

注:设置热成像调色板命令目前仅ZT30、ZT6 可用

#### 请求热成像相机原始数据

| CMD_ID:0x33------请求热成像相机原始数据 | | | |
| --- | --- | --- | --- |
| | | send 数据格式 | |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| | ACK 数据格式 | | |
| | uint8_t | mode | 0: 30 fps 1: 25 fps 并输出温度帧 |

#### CMD_ID:0x35------请求一次热成像相机温度帧 send 数据格式

#### CMD_ID:0x37------请求热成像增益模式

| | | |
| --- | --- | --- |
| 数据类型 | 数据名 | 数据说明 |
| | | ACK 数据格式 |
| uint8_t | Ir_gain | 0: 低增益 1: 高增益 |

| CMD_ID:0x37 | 请求热成像增益模式 | | |
| --- | --- | --- | --- |
| send数据格式 | | | |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| | ACK数据格式 | | |
| 1 | uint8_t | Ir_gain | 0:低增益 1:高增益 |

| send 数据格式 | | |
| --- | --- | --- |
| | | ACK 数据格式 |
| uint8_t | Ir_gain | 0: 低增益 1: 高增益 |

注:发送热成像增益模式到云台命令目前仅ZT30、ZT6 可用

#### 请求热成像环境校准开关

| 发送热成像环境校准命令到云台 | | |
| --- | --- | --- |
| CMD_ID:0x3A------发送热成像环境校准命令到云台 | | |
| 数据类型 | 数据名 | send 数据格式 数据说明 0: 关闭 |

注:此命令目前仅ZT30、ZT6 可用

#### 发送热成像环境校准命令到云台

| CMD_ID:0x3B------请求热成像环境校准参数 | | |
| --- | --- | --- |
| | | send 数据格式 |
| 数据类型 | 数据名 | 数据说明 |
| uint16_t | Dist | ACK 数据格式 距离(单位m) |
| uint16_t | Ems | 目标发射率(%) |
| uint16_t | Hum | 环境湿度(%) |
| uint16_t | Ta | 大气温度(单位°C) |

注:此命令目前仅ZT30、ZT6 可用

#### 请求热成像环境校准参数

| 请求热成像环境校准参数 CMD ID:0x3B | | | |
| --- | --- | --- | --- |
| | | | send数据格式 |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| ACK数据格式 | | | |
| 1 | uint16_t | Dist | 距离(单位m) |
| 2 | uint16_t | Ems | 目标发射率(%) |
| 3 | uint16_t | Hum | 环境湿度(%) |
| 4 | uint16_t | Ta | 大气温度(单位°C) |
| 5 | uint16_t | Tu | 反射温度(单位°C) |

注:
1、此协议的参数均除以100 保留两位小数
2、此命令目前仅ZT30、ZT6 可用

#### 发送热成像环境校准参数到云台

| send 数据格式 | | | |
| --- | --- | --- | --- |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| 1 | uint16_t | Dist | 距离(单位m) |
| 2 | uint16_t | Ems | 目标发射率(%) |
| 3 | uint16_t | Hum | 环境湿度(%) |
| 4 | uint16_t | Ta | 大气温度(单位°C) |
| 5 | uint16_t | Tu | 反射温度(单位°C) |
| | | | ACK 数据格式 |
| 1 | uint8_t | ack | 1:设置成功 |

注:
1、此协议的参数均除以100 保留两位小数
2、此命令目前仅ZT30、ZT6 可用

#### 读取激光测距信息

| CMD_ID:0x15------读取激光测距信息 | | | |
| --- | --- | --- | --- |
| | | | send 数据格式 |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| | ACK 数据格式 | | |
| 1 | uint16_t | info_type | 激光测距距离数值,低位在前,高位在后, 最小值50,数据单位dm |

注:读取激光测距信息命令目前仅ZT30 可用

#### 请求激光测距目标的经纬度信息

| CMD_ID:0x17------请求激光测距目标的经纬度信息 | | | |
| --- | --- | --- | --- |
| | | send 数据格式 | |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| ACK 数据格式 | | | |
| 1 | int32_t | lon_degE7 | 经度[degE7] Longitude (WGS84, EGM96 椭 球体) |
| 2 | int32_t | lat_degE7 | 纬度[degE7] Latitude (WGS84, EGM96 椭 球体) |

注:请求激光测距目标的经纬度信息命令目前仅ZT30 可用

#### 请求激光测距状态信息

| CMD_ID:0x31------请求激光状态信息 | | | | |
| --- | --- | --- | --- | --- |
| | | | | send 数据格式 |
| 序号 | 数据类型 | 数据名 | | 数据说明 |
| ACK 数据格式 | | | | |
| 1 | uint8_t | laser_state | | 1:激光测距打开 0:激光测距关闭 |

注:读取激光测距信息命令目前仅ZT30 可用

#### 发送激光测距状态到云台

| CMD_ID:0x32------发送激光测距状态到云台 | | | |
| --- | --- | --- | --- |
| | | send 数据格式 | |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| 1 | uint8_t | laser_state | 1:激光测距打开 0:激光测距关闭 |
| ACK 数据格式 | | | |
| 1 | uint8_t | sta | 1:设置成功 0:设置失败 |

注:发送激光测距状态到云台命令目前仅ZT30 可用

#### 将飞控姿态数据发送至云台UART 串口

| | | | send 数据格式 |
| --- | --- | --- | --- |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| 1 | float | roll | [rad] Roll angle (-pi..+pi) |
| 2 | float | pitch | [rad] Pitch angle (-pi/2..+pi/2) |
| 3 | float | yaw | [rad] Yaw angle (-pi..+pi) |
| 4 | float | rollspeed | [rad/s] Roll angular speed |
| 5 | float | pitchspeed | [rad/s] Pitch angular speed |
| 6 | float | yawspeed | [rad/s] Yaw angular speed |
| | ACK 数据格式 | | |

#### 请求飞控发送数据流至云台
CMD_ID:0x24------请求飞控发送数据流至云台 CMD ID:0x24

| send 数据格式 | | | |
| --- | --- | --- | --- |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| 1 | uint8_t | data_type | 1:姿态数据 2:RC 通道数据( 暂未使用) |
| 2 | uint8_t | data_freq | 输出频率: 0:关闭发送 1:2 Hz 2:4 Hz 3:5 Hz 4:10 Hz 5:20 Hz 6:50 Hz 7:100 Hz |
| ACK 数据格式 | | | |
| 1 | uint8_t | data_type | 1:姿态数据 2:RC 通道数据 |

#### 请求云台发送数据流

| CMD_ID:0x25------请求云台发送数据流 | | | |
| --- | --- | --- | --- |
| | | | send 数据格式 |
| 序号 | 数据类型 | 数据名 | 数据说明 |
| 1 | uint8_t | data_type | 1:姿态数据 2:激光测距数据 |
| 2 | uint8_t | data_freq | 输出频率: 0:关闭发送 1:2 Hz 2:4 Hz 3:5 Hz 4:10 Hz 5:20 Hz 6:50 Hz 7:100 Hz |
| ACK 数据格式 | | | |
| | uint8_t | data_type | 1:姿态数据 2:激光测距数据 |

注：
1、请求激光测距数据命令目前仅ZT30 可用

#### CMD_ID:0x48------格式化SDK

| | | |
| --- | --- | --- |
| | | send 数据格式 |
| 数据类型 | 数据名 | 数据说明 |
| | | ACK 数据格式 |
| uint8_t | format_sta | 0:格式化失败 1:格式化成功 |

| | | | |
| --- | --- | --- | --- |
| | uint8_t | Camera_reboot | 1:相机重启 | |
| | uint8_t | Gimbal_reset | 0:无动作 1:云台重启 | |
| | ACK 数据格式 | | | |
| | uint8_t | Camera_reboot_sta | 0:无动作 1:相机重启 | |
| | uint8_t | Gimbal_reset_st | 0:无动作 1:云台重启 | |

#### 云台相机软重启 CMD ID:0x80

| | | send数据格式 | | |
| --- | --- | --- | --- | --- |
| 序号 | 数据类型 | 数据名 | | 数据说明 |
| 1 | uint8_t | Camera_reboot | | 0:无动作 1:相机重启 |
| 2 | uint8_t | Gimbal_reset | | 0:无动作 1:云台重启 |
| ACK数据格式 | | | | |
| 1 | uint8_t | Camera_reboot_sta | | 0:无动作 1:相机重启 |
| 2 | uint8_t | Gimbal reset_st | | 0:无动作 1:云台重启 |

### 3.5.3 SDK 通讯接口
- TTL 串口
  - 波特率:115200
  - 数据位:8 位,停止位:1 位,无校验
- UDP
  - IP:192.168.144.25
  - 端口号:37260
- TCP
  - IP:192.168.144.25
  - 端口号:37260

心跳包数据:55 66 01 01 00 00 00 00 00 59 8B

### 3.5.4 SDK 通讯数据示例
- 请求云台相机当前工作模式：55 66 01 00 00 00 00 19 5D 57
- zoom 1：55 66 01 01 00 00 00 05 01 8d 64
- zoom -1：55 66 01 01 00 00 00 05 FF 5c 6a
- 绝对变倍(4.5 倍)：55 66 01 02 00 10 00 0f 04 05 6b 15
- 请求变焦相机当前状态最大变倍值：55 66 01 00 00 00 00 16 B2 A6
- 请求变焦相机当前变倍值：55 66 01 00 00 00 00 18 7C 47

>>>>>>> 72f602e1751dfffabca6b5833a9f397d87336ccc
Copyright 2025 SIYI 思翼科技All Rights Reserved.